<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Product Catalog with Filters</title>
  <style>
    :root {
      --bg: #f5f7fb;
      --card: #ffffff;
      --muted: #6b7280;
      --accent: #0f62fe;
      --max-width: 1200px;
    }
    html, body {
      height: 100%;
      margin: 0;
      font-family: Inter, ui-sans-serif, system-ui, Segoe UI, Roboto, "Helvetica Neue", Arial;
    }
    body {
      background: var(--bg);
      color: #0b1220;
      display: flex;
      justify-content: center;
      padding: 28px;
    }
    .container { max-width: var(--max-width); width: 100%; }
    header {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      align-items: center;
      margin-bottom: 20px;
    }
    h1 { margin: 0; font-size: 1.4rem; }
    .controls {
      display: flex;
      gap: 12px;
      flex: 1;
      flex-wrap: wrap;
      align-items: center;
      justify-content: flex-end;
    }
    .search {
      display: flex;
      align-items: center;
      gap: 8px;
      background: #fff;
      padding: 8px 12px;
      border-radius: 10px;
      box-shadow: 0 1px 2px rgba(16,24,40,0.04);
    }
    .search input { border: 0; outline: none; min-width: 200px; font-size: 0.95rem; }
    .layout { display: grid; grid-template-columns: 280px 1fr; gap: 20px; }
    @media (max-width: 880px) {
      .layout { grid-template-columns: 1fr; }
      .sidebar { order: 2; }
      .product-area { order: 1; }
    }
    .sidebar {
      background: var(--card);
      padding: 16px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(11,17,32,0.04);
    }
    .filter-group { margin-bottom: 16px; }
    .filter-group h3 { margin: 0 0 8px 0; font-size: 0.95rem; }
    .checkbox-list { display: flex; flex-direction: column; gap: 8px; }
    .price-range { display: flex; gap: 8px; align-items: center; }
    .price-range input[type=range] { width: 100%; }
    .toggle { display: flex; gap: 8px; align-items: center; }
    .product-area { display: flex; flex-direction: column; gap: 12px; }
    .toolbar {
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .sort-select, .badge {
      background: #fff;
      padding: 8px 10px;
      border-radius: 8px;
      box-shadow: 0 1px 2px rgba(16,24,40,0.04);
    }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 16px; }
    .card {
      background: var(--card);
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 8px 20px rgba(11,17,32,0.04);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .card img { width: 100%; height: 150px; object-fit: cover; border-radius: 8px; }
    .card h4 { margin: 0; font-size: 1rem; }
    .meta { display: flex; justify-content: space-between; align-items: center; gap: 8px; }
    .price { font-weight: 700; }
    .muted { color: var(--muted); font-size: 0.9rem; }
    .btn {
      background: var(--accent);
      color: white;
      border: 0;
      padding: 8px 10px;
      border-radius: 8px;
      cursor: pointer;
    }
    .btn.secondary { background: #e6eefc; color: var(--accent); }
    .empty {
      padding: 28px;
      text-align: center;
      color: var(--muted);
      background: linear-gradient(180deg, transparent, rgba(11,17,32,0.02));
      border-radius: 8px;
    }
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(2,6,23,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      z-index: 100;
    }
    .modal {
      background: var(--card);
      width: 100%;
      max-width: 900px;
      border-radius: 12px;
      overflow: auto;
      max-height: 90vh;
      padding: 18px;
    }
    .modal .modal-body { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .modal img { width: 100%; border-radius: 8px; height: 320px; object-fit: cover; }
    .close-btn { background: transparent; border: 0; font-size: 1.2rem; cursor: pointer; }
    @media (max-width: 700px) {
      .modal .modal-body { grid-template-columns: 1fr; }
      .modal img { height: 220px; }
    }
    .row { display: flex; gap: 8px; align-items: center; }
    .chip { padding: 6px 8px; background: #f3f6ff; border-radius: 8px; font-size: 0.85rem; }
    .count-badge { background: #eef2ff; color: #1e3a8a; padding: 6px 8px; border-radius: 999px; }
    footer { margin-top: 18px; color: var(--muted); font-size: 0.9rem; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>IBM FE — Product Catalog</h1>
        <div class="muted">Browse products — filter, search, and view details</div>
      </div>

      <div class="controls">
        <div class="search" title="Search products">
          <input id="searchInput" placeholder="Search products (name or description)..." aria-label="Search products" />
        </div>
        <div class="chip">Price: <span id="priceLabel">All</span></div>
      </div>
    </header>

    <main class="layout" aria-live="polite">
      <aside class="sidebar" id="sidebar">
        <div class="filter-group">
          <h3>Categories</h3>
          <div class="checkbox-list" id="categoryList"></div>
        </div>

        <div class="filter-group">
          <h3>Price range</h3>
          <div class="price-range">
            <input id="minPrice" type="number" min="0" style="width:80px" />
            <span class="muted">to</span>
            <input id="maxPrice" type="number" min="0" style="width:80px" />
          </div>
          <div style="margin-top:8px;">
            <input id="priceApply" class="btn secondary" type="button" value="Apply Price" />
            <input id="priceReset" class="btn" type="button" value="Reset" style="background:#efefef;color:#111;margin-left:8px" />
          </div>
        </div>

        <div class="filter-group">
          <h3>Availability</h3>
          <label class="toggle"><input id="inStockOnly" type="checkbox" /> <span class="muted">Show in-stock only</span></label>
        </div>

        <div class="filter-group">
          <h3>Actions</h3>
          <div class="row">
            <button id="clearFilters" class="btn" title="Clear all filters">Clear filters</button>
            <button id="resetAll" class="btn secondary" title="Reset everything">Reset</button>
          </div>
        </div>

        <footer>
          <div>Local data (in-memory). Connect to API by replacing the product source in <code>app.products</code>.</div>
        </footer>
      </aside>

      <section class="product-area" id="productArea">
        <div class="toolbar">
          <div class="row">
            <div class="badge">Showing <span id="resultCount">0</span> products</div>
            <div style="width:8px"></div>
            <div class="muted" id="activeFilters">No filters applied</div>
          </div>

          <div class="row">
            <label class="muted">Sort</label>
            <select id="sortSelect" class="sort-select" aria-label="Sort products">
              <option value="relevance">Relevance</option>
              <option value="price_asc">Price: Low → High</option>
              <option value="price_desc">Price: High → Low</option>
              <option value="name_asc">Name: A → Z</option>
              <option value="name_desc">Name: Z → A</option>
            </select>
          </div>
        </div>

        <div id="productsGrid" class="grid" aria-live="polite" aria-atomic="true"></div>
        <div id="emptyMessage" class="empty" style="display:none">No products match your filters.</div>
      </section>
    </main>
  </div>

  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-hidden="true">
    <div class="modal" role="document" aria-modal="true" aria-labelledby="modalTitle">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
        <h2 id="modalTitle" style="margin:0; font-size:1.05rem"></h2>
        <button id="modalClose" class="close-btn" aria-label="Close">✕</button>
      </div>
      <div class="modal-body">
        <div><img id="modalImage" src="" alt="Product image" /></div>
        <div>
          <div id="modalPrice" style="font-size:1.2rem; font-weight:700; margin-bottom:6px;"></div>
          <div id="modalStock" class="muted" style="margin-bottom:10px"></div>
          <div id="modalDesc" style="margin-bottom:12px;"></div>
          <div style="margin-bottom:12px;"><strong>Category:</strong> <span id="modalCategory" class="chip"></span></div>
          <div id="modalFeatures"></div>
          <div style="margin-top:16px;">
            <button id="modalBuy" class="btn">Add to cart</button>
            <button id="modalClose2" class="btn secondary" style="margin-left:8px">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
  const $ = (sel, ctx=document) => ctx.querySelector(sel);
  const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

  const app = {
    products: [
      { id: 'p1', name: 'Business Laptop Pro 14"', category: 'Electronics', price: 1299, available: true, description: '14" laptop with 16GB RAM, 512GB SSD', imageUrl: 'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=1200&q=60', features: ['16GB RAM','512GB SSD','Intel i7'] },
      { id: 'p2', name: 'Wireless Headphones', category: 'Electronics', price: 199, available: true, description: 'Noise-cancelling over-ear headphones', imageUrl: 'https://images.unsplash.com/photo-1518444020090-6f274f18c9a0?w=1200&q=60', features: ['ANC','20hr battery'] },
      { id: 'p3', name: 'Classic Cotton Shirt', category: 'Clothing', price: 39, available: true, description: 'Soft cotton shirt available in multiple sizes', imageUrl: 'https://images.unsplash.com/photo-1521335629791-ce4aec67ddc5?w=1200&q=60', features: ['100% cotton','Machine wash'] },
      { id: 'p4', name: 'Modern Bookshelf', category: 'Furniture', price: 249, available: false, description: 'Solid wood bookshelf with 5 tiers', imageUrl: 'https://images.unsplash.com/photo-1505691723518-36a4074bdb8a?w=1200&q=60', features: ['Solid oak','5 tiers'] },
      { id: 'p5', name: 'Smartphone X200', category: 'Electronics', price: 899, available: true, description: '6.7" AMOLED, 128GB storage', imageUrl: 'https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=1200&q=60', features: ['AMOLED','128GB'] },
      { id: 'p6', name: 'Paperback Notebook: "Design Patterns"', category: 'Books', price: 29, available: true, description: 'A practical guide to software design patterns', imageUrl: 'https://images.unsplash.com/photo-1512820790803-83ca734da794?w=1200&q=60', features: ['Author: J. Doe','350 pages'] },
      { id: 'p7', name: 'Running Shoes Classic', category: 'Clothing', price: 79, available: false, description: 'Lightweight running shoes for daily training', imageUrl: 'https://images.unsplash.com/photo-1528701800484-1c5a5a5376a8?w=1200&q=60', features: ['Breathable mesh','Rubber sole'] },
      { id: 'p8', name: 'Ergonomic Office Chair', category: 'Furniture', price: 349, available: true, description: 'Adjustable height and lumbar support', imageUrl: 'https://images.unsplash.com/photo-1585559604303-9ea1f4b0ea80?w=1200&q=60', features: ['Lumbar support','Adjustable armrests'] }
    ],
    state: {
      search: '',
      categories: new Set(),
      minPrice: null,
      maxPrice: null,
      inStockOnly: false,
      sort: 'relevance'
    }
  };

  const searchInput = $('#searchInput');
  const categoryList = $('#categoryList');
  const productsGrid = $('#productsGrid');
  const resultCount = $('#resultCount');
  const emptyMessage = $('#emptyMessage');
  const priceLabel = $('#priceLabel');
  const minPriceInput = $('#minPrice');
  const maxPriceInput = $('#maxPrice');
  const priceApplyBtn = $('#priceApply');
  const priceResetBtn = $('#priceReset');
  const inStockOnlyCheckbox = $('#inStockOnly');
  const sortSelect = $('#sortSelect');
  const activeFilters = $('#activeFilters');
  const clearFiltersBtn = $('#clearFilters');
  const resetAllBtn = $('#resetAll');

  const modalBackdrop = $('#modalBackdrop');
  const modalTitle = $('#modalTitle');
  const modalImage = $('#modalImage');
  const modalPrice = $('#modalPrice');
  const modalStock = $('#modalStock');
  const modalDesc = $('#modalDesc');
  const modalCategory = $('#modalCategory');
  const modalFeatures = $('#modalFeatures');
  const modalClose = $('#modalClose');
  const modalClose2 = $('#modalClose2');

  function init(){
    renderCategoryFilters();
    attachEventListeners();
    const prices = app.products.map(p=>p.price);
    minPriceInput.value = Math.min(...prices);
    maxPriceInput.value = Math.max(...prices);
    app.state.minPrice = null;
    app.state.maxPrice = null;
    render();
  }

  function renderCategoryFilters(){
    const cats = Array.from(new Set(app.products.map(p=>p.category))).sort();
    categoryList.innerHTML = '';
    cats.forEach(cat=>{
      const id = `cat_${cat.replace(/\s+/g,'_')}`;
      const label = document.createElement('label');
      label.style.display = 'flex';
      label.style.alignItems = 'center';
      label.style.gap = '8px';
      label.innerHTML = `<input type="checkbox" data-cat="${cat}" id="${id}"> <span>${cat}</span>`;
      categoryList.appendChild(label);
    });
  }

  function filterProducts(){
    let items = app.products.slice();
    const q = app.state.search.trim().toLowerCase();
    if(q){
      items = items.filter(p => (p.name + ' ' + p.description + ' ' + (p.features||[]).join(' ')).toLowerCase().includes(q));
    }
    if(app.state.categories.size > 0){
      items = items.filter(p => app.state.categories.has(p.category));
    }
    if(app.state.minPrice != null){ items = items.filter(p => p.price >= app.state.minPrice); }
   if (app.state.maxPrice != null) { 
  items = items.filter(p => p.price <= app.state.maxPrice); 
}
    if(app.state.maxPrice != null){ 
      items = items.filter(p => p.price <= app.state.maxPrice); 
    }
    if(app.state.inStockOnly){ 
      items = items.filter(p => p.available); 
    }

    // Sorting
    switch(app.state.sort){
      case 'price_asc': items.sort((a,b)=>a.price-b.price); break;
      case 'price_desc': items.sort((a,b)=>b.price-a.price); break;
      case 'name_asc': items.sort((a,b)=>a.name.localeCompare(b.name)); break;
      case 'name_desc': items.sort((a,b)=>b.name.localeCompare(a.name)); break;
      default: break;
    }
    return items;
  }

  function render(){
    const items = filterProducts();
    productsGrid.innerHTML = '';
    if(items.length === 0){
      emptyMessage.style.display = 'block';
      resultCount.textContent = 0;
      return;
    } else {
      emptyMessage.style.display = 'none';
      resultCount.textContent = items.length;
    }

    items.forEach(p=>{
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img src="${p.imageUrl}" alt="${p.name}">
        <h4>${p.name}</h4>
        <div class="meta">
          <div class="price">$${p.price}</div>
          <div class="muted">${p.available ? 'In Stock' : 'Out of Stock'}</div>
        </div>
        <button class="btn secondary" data-id="${p.id}">View Details</button>
      `;
      productsGrid.appendChild(card);
    });

    updateActiveFilters();
    $$('.card .btn.secondary', productsGrid).forEach(btn=>{
      btn.addEventListener('click', e=>{
        const id = e.target.dataset.id;
        openModal(id);
      });
    });
  }

  function updateActiveFilters(){
    const parts = [];
    if(app.state.search) parts.push(`Search: "${app.state.search}"`);
    if(app.state.categories.size>0) parts.push(`Categories: ${Array.from(app.state.categories).join(', ')}`);
    if(app.state.minPrice!=null||app.state.maxPrice!=null){
      const min=app.state.minPrice??'0';
      const max=app.state.maxPrice??'∞';
      parts.push(`Price: ${min} - ${max}`);
    }
    if(app.state.inStockOnly) parts.push('In-stock only');
    activeFilters.textContent = parts.length ? parts.join(' | ') : 'No filters applied';
  }

  function openModal(id){
    const p = app.products.find(x=>x.id===id);
    if(!p) return;
    modalTitle.textContent = p.name;
    modalImage.src = p.imageUrl;
    modalPrice.textContent = `$${p.price}`;
    modalStock.textContent = p.available ? 'In Stock' : 'Out of Stock';
    modalDesc.textContent = p.description;
    modalCategory.textContent = p.category;
    modalFeatures.innerHTML = p.features.map(f=>`<div class="chip">${f}</div>`).join(' ');
    modalBackdrop.style.display = 'flex';
    modalBackdrop.setAttribute('aria-hidden','false');
  }

  function closeModal(){
    modalBackdrop.style.display = 'none';
    modalBackdrop.setAttribute('aria-hidden','true');
  }

  function attachEventListeners(){
    searchInput.addEventListener('input', e=>{
      app.state.search = e.target.value;
      render();
    });

    categoryList.addEventListener('change', e=>{
      if(e.target.dataset.cat){
        const cat = e.target.dataset.cat;
        if(e.target.checked) app.state.categories.add(cat);
        else app.state.categories.delete(cat);
        render();
      }
    });

    priceApplyBtn.addEventListener('click', ()=>{
      const min = parseFloat(minPriceInput.value);
      const max = parseFloat(maxPriceInput.value);
      app.state.minPrice = isNaN(min)?null:min;
      app.state.maxPrice = isNaN(max)?null:max;
      priceLabel.textContent = `${app.state.minPrice ?? '0'} - ${app.state.maxPrice ?? '∞'}`;
      render();
    });

    priceResetBtn.addEventListener('click', ()=>{
      minPriceInput.value = '';
      maxPriceInput.value = '';
      app.state.minPrice = null;
      app.state.maxPrice = null;
      priceLabel.textContent = 'All';
      render();
    });

    inStockOnlyCheckbox.addEventListener('change', e=>{
      app.state.inStockOnly = e.target.checked;
      render();
    });

    sortSelect.addEventListener('change', e=>{
      app.state.sort = e.target.value;
      render();
    });

    clearFiltersBtn.addEventListener('click', ()=>{
      app.state.search='';
      app.state.categories.clear();
      app.state.minPrice=null;
      app.state.maxPrice=null;
      app.state.inStockOnly=false;
      app.state.sort='relevance';
      searchInput.value='';
      $$('input[type=checkbox]', categoryList).forEach(cb=>cb.checked=false);
      minPriceInput.value='';
      maxPriceInput.value='';
      inStockOnlyCheckbox.checked=false;
      sortSelect.value='relevance';
      priceLabel.textContent='All';
      render();
    });

    resetAllBtn.addEventListener('click', ()=>window.location.reload());

    modalClose.addEventListener('click', closeModal);
    modalClose2.addEventListener('click', closeModal);
    modalBackdrop.addEventListener('click', e=>{
      if(e.target===modalBackdrop) closeModal();
    });
  }

  window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
